# 配置ルール

## 日別配置パターン

| シフト種類 | 平日 | 土曜 | 日祝 | 配置条件 |
|---|---|---|---|---|
| 外来L | 1名 | 1名 | - | 外来L可能フラグ |
| 処置室 | 1〜5名 | 1〜5名 | - | フリー枠（病棟担当不可のメンバーの吸収先） |
| 美容 | 1名 | 1名 | - | 美容可能フラグ |
| MW外来 | 1〜2名 | 1〜2名 | - | MW外来可能フラグ。小児科医出勤日は2名 |
| 病棟L | 1名 | 1名 | 1名 | 病棟L可能 + 病棟担当フラグ |
| 病棟 | 1〜5名 | 1〜5名 | 1〜3名 | 病棟担当フラグ。フリー枠（余剰人員の吸収先） |
| 分娩 | 1名 | 0〜1名 | 0〜1名 | 助産師 + 病棟担当フラグ |
| 分娩担当 | 1名 | 1名 | 1名 | 助産師 + 病棟担当フラグ |
| 夜勤L | 1名 | 1名 | 1名 | 夜勤L可能フラグ |
| 夜勤 | 1名 | 1名 | 1名 | 夜勤可能フラグ |

## フリー枠ルール

各ポジションに配置後、勤務日数を満たすために余剰となるメンバーをフリー枠に配置する。

- 病棟担当フラグを持つメンバー → **病棟**に追加配置（最大5名）
- 病棟担当フラグを持たないメンバー → **処置室**に追加配置（最大5名）

これにより、常勤メンバーの公休日数を規定通りに維持しつつ、全員を配置できる。

## 新人配置ルール

新人フラグを持つメンバーが病棟系に配置される日は、病棟ポジションを1枠追加し5名体制とする（通常4名：病棟L、病棟、分娩、分娩担当）。

## 公休日数

### 常勤

| 月の日数 | 基本公休 | 勤務日数 |
|---|---|---|
| 31日 | 10日 | 21日 |
| 30日 | 9日 | 21日 |
| 28日 | 8日 | 20日 |

#### 夜勤による公休調整

members.night_shift_deduction_balance を夜勤1回ごとに+1。8に到達した月の公休を-1し、バランスを0にリセット。

### 非常勤

非常勤メンバーは公休日数の規定に縛られない。夜勤上限回数分だけ出勤し、残りは全て公休となる。

- 公休日数 = 月の日数 - 夜勤上限回数
- 公休は最低保証（`>=`）であり、夜勤翌日の強制休みも含めて柔軟に休みが増える

## 希望休

- 常勤: 月3日まで
- パート: 制限なし
- 原則として全ての希望休を叶える
