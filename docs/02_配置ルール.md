# 配置ルール

## 日別配置パターン

| シフト種類 | 平日 | 土曜 | 日祝 | 配置条件 |
|---|---|---|---|---|
| 外来L | 1名 | 1名 | - | 外来L可能フラグ |
| 処置室 | 1名 | 1名 | - | |
| 美容 | 1名 | 1名 | - | 美容可能フラグ |
| MW外来 | 1〜2名 | 1〜2名 | - | MW外来可能フラグ。小児科医出勤日は2名 |
| 病棟L | 1名 | 1名 | 1名 | 病棟L可能 + 病棟担当フラグ |
| 病棟 | 1〜2名 | 1〜2名 | 1〜2名 | 病棟担当フラグ |
| 分娩 | 1名 | 0〜1名 | 0〜1名 | 助産師 + 病棟担当フラグ |
| 分娩担当 | 1名 | 1名 | 1名 | 助産師 + 病棟担当フラグ |
| 病棟フリー | 0〜∞名 | 0〜∞名 | 0〜∞名 | 病棟担当フラグ。余剰人員の吸収先 |
| 外来フリー | 0〜∞名 | 0〜∞名 | - | 日勤可能メンバーの余剰吸収先 |
| 夜勤L | 1名 | 1名 | 1名 | 夜勤L可能フラグ |
| 夜勤 | 1名 | 1名 | 1名 | 夜勤可能フラグ |

## フリー枠ルール

各ポジションに配置後、勤務日数を満たすために余剰となるメンバーをフリー枠に配置する。

- 病棟担当フラグを持つメンバー → **病棟フリー**に配置（人数制限なし）
- それ以外の日勤可能メンバー → **外来フリー**に配置（人数制限なし）
- 日祝は**病棟フリー**のみ（外来フリーは H14 により自動的にブロック）

ソルバーが直接フリー枠に配置するため、後処理は不要。

## 早番ルール

- 平日に早番可能フラグを持つメンバーの中から1名を早番として割り当てる
- 早番者は通常の日勤シフトに加えて早番フラグが付与される（シフト種別は変わらない）
- 土日祝は早番なし
- ソルバーが自動割り当てし、生成後に手動で変更も可能

## 新人配置ルール

新人フラグを持つメンバーが病棟系に配置される日は、病棟ポジションを1枠追加し5名体制とする（通常4名：病棟L、病棟、分娩、分娩担当）。

## 公休日数

### 常勤

| 月の日数 | 基本公休 | 勤務日数 |
|---|---|---|
| 31日 | 10日 | 21日 |
| 30日 | 9日 | 21日 |
| 28日 | 8日 | 20日 |

#### 夜勤による公休調整

members.night_shift_deduction_balance を夜勤1回ごとに+1。8に到達した月の公休を-1し、バランスを0にリセット。

### 非常勤

非常勤メンバーは公休日数の規定に縛られない。夜勤上限回数分だけ出勤し、残りは全て公休となる。

- 公休日数 = 月の日数 - 夜勤上限回数
- 公休は最低保証（`>=`）であり、夜勤翌日の強制休みも含めて柔軟に休みが増える

## 希望休

- 常勤: 月3日まで
- パート: 制限なし
- 原則として全ての希望休を叶える
