# アプリケーション仕様

## 全体方針

- 管理者（シフト作成者）が全操作を行う単一ユーザーアプリケーション
- 認証なし
- スタッフへのシフト共有はPDF出力で行う

## 画面一覧

| # | 画面名 | 概要 |
|---|---|---|
| P1 | メンバー管理 | スタッフの登録・編集・削除、能力フラグ管理 |
| P2 | NGペア管理 | 夜勤NGペアの登録・削除 |
| P3 | 月次設定 | 希望休入力、小児科医出勤日の登録 |
| P4 | シフト生成・編集 | シフト自動生成、シフト表表示、手動編集、サマリー表示 |
| P5 | PDF出力 | シフト表のPDF出力 |

## P1: メンバー管理画面

### 一覧表示

メンバー全員を表形式で表示する。

| 表示項目 | 説明 |
|---|---|
| 名前 | メンバー名 |
| 職能 | 看護師 / 准看護師 / 助産師 |
| 雇用形態 | 常勤 / パート |
| 夜勤上限 | 月の夜勤上限回数 |
| 能力フラグ | 保有フラグをバッジで表示 |

### 登録・編集・コピー

- 名前、職能、雇用形態、夜勤上限を入力
- 能力フラグをチェックボックスで選択（複数選択可、早番可能を含む）
- アクション: 編集 / コピー / 削除
- コピー: 元メンバーと同じ属性（職能、雇用形態、夜勤上限、能力フラグ）で新規作成。名前に「（コピー）」を付与

## P2: NGペア管理画面

- 現在のNGペアを一覧表示
- メンバー2名をドロップダウンで選択して追加
- 一覧から削除

## P3: 月次設定画面

### 希望休入力

- 対象年月を選択
- 縦=メンバー、横=日付（1日〜末日）の表形式
- セルクリックで3状態サイクル切り替え（空 → 公休 → 有給 → 空）
  - 公休: 青ドット（bg-brand-500）
  - 有給: オレンジドット（bg-amber-500）
- テーブル上部に凡例を表示
- 常勤メンバーが3日を超えて希望休を入力した場合は警告を表示
- パートは制限なし

### 小児科医出勤日

- 対象年月を選択
- 日付一覧でクリックしてON/OFF

## P4: シフト生成・編集画面

### サマリーパネル

メンバーごとの集計を表形式で画面上部に表示する。

| 表示項目 | 説明 |
|---|---|
| メンバー名 | |
| 勤務日数 | day_off/paid_leave以外の日数 |
| 公休日数 | day_offの日数 |
| 有給日数 | paid_leaveの日数 |
| 夜勤回数 | night_leader + night の合計 |
| 早番回数 | 早番に割り当てられた日数 |
| 日祝出勤数 | 日曜・祝日に勤務した日数 |
| 希望休充足 | 叶えた数 / 希望数（全て叶えていれば ✓） |

### シフト表（メインエリア）

現行シフト表と同じレイアウトで表示する。

- 縦軸: 日付（1日〜末日）+ 曜日
- 横軸: シフト種類（外来L、処置室、美容、MW外来、病棟L、病棟、分娩、分娩担当、夜勤L、夜勤）
- セル: メンバー名を表示。早番のメンバーには「早」アイコンを付与

### 操作

| 操作 | 説明 |
|---|---|
| シフト生成 | 対象年月を選択し「生成」ボタンでソルバーを実行。解が見つからない場合は具体的な原因を表示 |
| 手動編集 | セルクリックでドロップダウンを表示。そのポジション・日付に配置可能なメンバー候補から選択 |
| 早番トグル | セルのドロップダウンから早番の設定・解除が可能 |
| 公休↔有給切替 | 公休/有給のシフトのドロップダウンから「有給にする」/「公休にする」で切替可能 |
| アラート | 叶えられなかった希望休がある場合、対象メンバーと日付を表示 |
| PDF出力 | 「PDF出力」ボタンでシフト表をPDFとしてダウンロード |

## P5: PDF出力

### レイアウト

現行のシフト表と同じ形式で出力する。

- 縦軸: 日付（1日〜末日）+ 曜日
- 横軸: シフト種類
- セル: メンバー名（早番のメンバー名には★マークを付与）
- 用紙: A4横向き
